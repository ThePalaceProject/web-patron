# Set an instance name to be used in bug tracking and for other debugging purposes.
# This is not patron-facing, so call it something that will be meaningful to you when
# reviewing bugs, especially if you operate multiple instances.
instance_name: Patron Web Catalog - Community Demo

# APP MEDIA SUPPORT
# Each entry has a setting of "show", "redirect" or "show-and-redirect".
#
# "redirect" tells the app to display a prompt directing the
# user to read the book in the companion mobile app (usually SimplyE).
#
# The default for unlisted entries is unsupported. The format will be
# completely hidden. Any OPDS Entry with only this one unsupported format
# will not be visible in the app.
media_support:
  # standard download types
  application/epub+zip: show
  application/kepub+zip: show
  application/pdf: show
  application/x-mobipocket-ebook: show
  application/x-mobi8-ebook: show
  application/vnd.overdrive.circulation.api+json;profile=ebook: show
  # External read online type (Like Overdrive)
  text/html;profile="http://librarysimplified.org/terms/profiles/streaming-media": show
  text/html;profile=http://librarysimplified.org/terms/profiles/streaming-media: show
  # Demarque web reader
  text/html: show
  # AxisNow document (read online in Webpub Viewer) - not supported in community version
  # application/vnd.librarysimplified.axisnow+json: show
  # Audiobooks
  application/audiobook+json: redirect
  application/vnd.overdrive.circulation.api+json;profile=audiobook: redirect
  application/audiobook+json;profile="http://www.feedbooks.com/audiobooks/access-restriction": redirect
  application/vnd.librarysimplified.findaway.license+json: redirect

  ### INDIRECT TYPES
  # OPDS Entry Indirection type
  application/atom+xml;type=entry;profile=opds-catalog:
    text/html;profile="http://librarysimplified.org/terms/profiles/streaming-media": show

  # Adobe Encryption
  application/vnd.adobe.adept+xml:
    application/epub+zip: redirect-and-show

  # Bearer Token Exchange
  application/vnd.librarysimplified.bearer-token+json:
    application/pdf: show
    application/epub+zip: show

# defines the companion app for the instance. Can be "simplye" or "openebooks"
# default is "simplye"
companion_app: simplye

# BUGSNAG: defines the bugsnag api key to integrate error tracking
# bugsnag_api_key: xxx

# GOOGLE TAG MANAGER: defines the google tag manager id to integrate web analytics
# gtm_id: xxx

# There are also some environment variables that can be set in the .env.local
# file. They are set there because they're for development, not production
# configuration.

# REQUIRED LIBRARY CONFIG
#
# There are three ways to configure libraries:
#
# 1. STATIC LIBRARIES (recommended for a few known libraries):
#    Define libraries as a dictionary mapping slug to authentication document URL.
#    These libraries are available immediately at build time.
#
libraries:
  main-street-city: https://demo.thepalaceproject.org/GA0000/authentication_document
# 2. RUNTIME LIBRARY REGISTRIES (recommended for dynamic library lists):
#    Define one or more library registry URLs that will be fetched at runtime.
#    This allows libraries to be added/removed without rebuilding the application.
#    NOTE: Runtime fetching is implemented in Release 1. In Release 0, this config
#    is parsed but registries are not yet fetched at runtime.
#
# registries:
#   - url: https://registry.thepalaceproject.org/libraries
#     refreshMinInterval: 60   # Minimum seconds between fetch attempts (default: 60)
#     refreshMaxInterval: 300  # Maximum seconds after last successful fetch before auto-refresh (default: 300)
#
# You can also define multiple registries (earlier registries take precedence for slug conflicts):
# registries:
#   - url: https://registry.thepalaceproject.org/libraries
#     refreshMinInterval: 60
#     refreshMaxInterval: 300
#   - url: https://regional-registry.example.com/libraries
#     refreshMinInterval: 120
#     refreshMaxInterval: 600
#
# 3. HYBRID (static + registries):
#    Combine static libraries with runtime registries. Static libraries always
#    take precedence over registry libraries if there are slug conflicts.
#
# libraries:
#   featured-lib: https://example.com/featured/auth
# registries:
#   - url: https://registry.thepalaceproject.org/libraries
#
# DEPRECATED FORMAT (still supported for backward compatibility):
# Using a string for 'libraries' is deprecated. This format fetches the registry
# at BUILD TIME only, not runtime. Please migrate to the 'registries' array format.
#
# libraries: https://registry.thepalaceproject.org/libraries  # DEPRECATED
#
# MIGRATION INSTRUCTIONS:
# If you're currently using the string format:
#   OLD (deprecated):
#     libraries: https://registry.thepalaceproject.org/libraries
#
#   NEW (recommended):
#     registries:
#       - url: https://registry.thepalaceproject.org/libraries
#         refreshMinInterval: 60
#         refreshMaxInterval: 300
#
# After updating to the new format:
# 1. With Release 0: Libraries still fetched at build time (no behavior change)
# 2. With Release 1: Libraries fetched at runtime (no rebuild needed for library changes)
